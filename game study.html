<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fantasy Study Quest Timer</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes pulse {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 1; }
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .animate-pulse {
      animation: pulse 3s ease-in-out infinite;
    }
    .animate-bounce {
      animation: bounce 2s ease-in-out infinite;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    const FantasyStudyTimer = () => {
      const [timerMode, setTimerMode] = useState('countdown');
      const [isRunning, setIsRunning] = useState(false);
      const [time, setTime] = useState(0);
      const [inputMinutes, setInputMinutes] = useState(30);
      const [sessionStartTime, setSessionStartTime] = useState(0);
      
      const [pomodoroPhase, setPomodoroPhase] = useState('work');
      const [pomodoroWork, setPomodoroWork] = useState(25);
      const [pomodoroBreak, setPomodoroBreak] = useState(5);
      
      const [totalPoints, setTotalPoints] = useState(0);
      const [level, setLevel] = useState(1);
      const [totalStudyTime, setTotalStudyTime] = useState(0);
      const [sessionsCompleted, setSessionsCompleted] = useState(0);
      const [currentStreak, setCurrentStreak] = useState(0);
      const [lastStudyDate, setLastStudyDate] = useState(null);
      
      const [unlockedCompanions, setUnlockedCompanions] = useState(['dragon']);
      const [currentCompanion, setCurrentCompanion] = useState('dragon');
      const [unlockedTitles, setUnlockedTitles] = useState(['Novice Scholar']);
      const [currentTitle, setCurrentTitle] = useState('Novice Scholar');
      const [showReward, setShowReward] = useState(false);
      const [rewardMessage, setRewardMessage] = useState('');
      
      const intervalRef = useRef(null);

      const companions = {
        dragon: { emoji: 'üêâ', name: 'Baby Dragon', unlockLevel: 1 },
        phoenix: { emoji: 'üî•', name: 'Phoenix', unlockLevel: 3 },
        unicorn: { emoji: 'ü¶Ñ', name: 'Unicorn', unlockLevel: 5 },
        owl: { emoji: 'ü¶â', name: 'Wise Owl', unlockLevel: 7 },
        fairy: { emoji: 'üßö', name: 'Study Fairy', unlockLevel: 10 },
        crystal: { emoji: 'üíé', name: 'Crystal Guardian', unlockLevel: 15 }
      };

      const titles = [
        { name: 'Novice Scholar', level: 1 },
        { name: 'Knowledge Seeker', level: 3 },
        { name: 'Study Warrior', level: 5 },
        { name: 'Wisdom Keeper', level: 8 },
        { name: 'Master of Focus', level: 12 },
        { name: 'Legendary Sage', level: 20 }
      ];

      useEffect(() => {
        const newLevel = Math.floor(totalPoints / 100) + 1;
        if (newLevel > level) {
          setLevel(newLevel);
          checkRewards(newLevel);
        }
      }, [totalPoints]);

      const checkRewards = (newLevel) => {
        Object.entries(companions).forEach(([key, companion]) => {
          if (companion.unlockLevel === newLevel && !unlockedCompanions.includes(key)) {
            setUnlockedCompanions([...unlockedCompanions, key]);
            setRewardMessage(`üéâ New companion unlocked: ${companion.name} ${companion.emoji}`);
            setShowReward(true);
            setTimeout(() => setShowReward(false), 3000);
          }
        });

        const newTitle = titles.filter(t => t.level === newLevel)[0];
        if (newTitle && !unlockedTitles.includes(newTitle.name)) {
          setUnlockedTitles([...unlockedTitles, newTitle.name]);
          setCurrentTitle(newTitle.name);
          setRewardMessage(`üèÜ New title earned: ${newTitle.name}`);
          setShowReward(true);
          setTimeout(() => setShowReward(false), 3000);
        }
      };

      const calculatePoints = (durationInMinutes) => {
        if (durationInMinutes < 5) return Math.floor(durationInMinutes);
        if (durationInMinutes < 30) return Math.floor(durationInMinutes * 0.3);
        if (durationInMinutes <= 60) {
          return Math.floor(10 + ((durationInMinutes - 30) / 30) * 15);
        }
        return Math.floor(25 + (durationInMinutes - 60) * 0.3);
      };

      const updateStreak = () => {
        const today = new Date().toDateString();
        if (lastStudyDate !== today) {
          const yesterday = new Date(Date.now() - 86400000).toDateString();
          if (lastStudyDate === yesterday) {
            setCurrentStreak(currentStreak + 1);
          } else if (lastStudyDate === null) {
            setCurrentStreak(1);
          } else {
            setCurrentStreak(1);
          }
          setLastStudyDate(today);
        }
      };

      const endSession = (duration) => {
        const durationInMinutes = duration / 60;
        const points = calculatePoints(durationInMinutes);
        setTotalPoints(totalPoints + points);
        setTotalStudyTime(totalStudyTime + duration);
        setSessionsCompleted(sessionsCompleted + 1);
        updateStreak();
      };

      useEffect(() => {
        if (isRunning) {
          intervalRef.current = setInterval(() => {
            if (timerMode === 'countdown' || timerMode === 'pomodoro') {
              setTime(prev => {
                if (prev <= 1) {
                  setIsRunning(false);
                  const sessionDuration = sessionStartTime;
                  endSession(sessionDuration);
                  
                  if (timerMode === 'pomodoro') {
                    if (pomodoroPhase === 'work') {
                      setPomodoroPhase('break');
                      setTime(pomodoroBreak * 60);
                    } else {
                      setPomodoroPhase('work');
                      setTime(pomodoroWork * 60);
                    }
                  }
                  return 0;
                }
                return prev - 1;
              });
            } else {
              setTime(prev => prev + 1);
            }
          }, 1000);
        } else {
          if (intervalRef.current) {
            clearInterval(intervalRef.current);
          }
        }
        return () => {
          if (intervalRef.current) {
            clearInterval(intervalRef.current);
          }
        };
      }, [isRunning, timerMode, pomodoroPhase]);

      const startTimer = () => {
        if (timerMode === 'countdown' && time === 0) {
          const initialTime = inputMinutes * 60;
          setTime(initialTime);
          setSessionStartTime(initialTime);
        } else if (timerMode === 'pomodoro' && time === 0) {
          const initialTime = pomodoroWork * 60;
          setTime(initialTime);
          setSessionStartTime(initialTime);
          setPomodoroPhase('work');
        } else if (timerMode === 'stopwatch' && time === 0) {
          setSessionStartTime(0);
        }
        setIsRunning(true);
      };

      const pauseTimer = () => {
        setIsRunning(false);
      };

      const resetTimer = () => {
        setIsRunning(false);
        if (timerMode === 'stopwatch' && time > 0) {
          endSession(time);
        }
        setTime(0);
        setSessionStartTime(0);
        setPomodoroPhase('work');
      };

      const formatTime = (seconds) => {
        const hrs = Math.floor(seconds / 3600);
        const mins = Math.floor((seconds % 3600) / 60);
        const secs = seconds % 60;
        if (hrs > 0) {
          return `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
      };

      const formatDuration = (seconds) => {
        const hrs = Math.floor(seconds / 3600);
        const mins = Math.floor((seconds % 3600) / 60);
        if (hrs > 0) return `${hrs}h ${mins}m`;
        return `${mins}m`;
      };

      // Lucide React icons as SVG
      const PlayIcon = () => (
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <polygon points="5 3 19 12 5 21 5 3"></polygon>
        </svg>
      );

      const PauseIcon = () => (
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <rect x="6" y="4" width="4" height="16"></rect>
          <rect x="14" y="4" width="4" height="16"></rect>
        </svg>
      );

      const RotateCcwIcon = () => (
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <polyline points="1 4 1 10 7 10"></polyline>
          <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
        </svg>
      );

      const AwardIcon = () => (
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <circle cx="12" cy="8" r="7"></circle>
          <polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline>
        </svg>
      );

      const FlameIcon = () => (
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path>
        </svg>
      );

      const ClockIcon = () => (
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
      );

      return (
        <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 text-white p-4 overflow-auto">
          <div className="fixed inset-0 overflow-hidden pointer-events-none">
            {[...Array(20)].map((_, i) => (
              <div
                key={i}
                className="absolute animate-pulse"
                style={{
                  left: `${Math.random() * 100}%`,
                  top: `${Math.random() * 100}%`,
                  animationDelay: `${Math.random() * 3}s`,
                  animationDuration: `${2 + Math.random() * 3}s`
                }}
              >
                ‚ú®
              </div>
            ))}
          </div>

          <div className="max-w-6xl mx-auto relative z-10">
            <div className="text-center mb-8">
              <div className="flex items-center justify-center gap-3 mb-2">
                <span className="text-6xl animate-bounce">{companions[currentCompanion].emoji}</span>
              </div>
              <h1 className="text-5xl font-bold bg-gradient-to-r from-yellow-300 via-pink-300 to-purple-300 bg-clip-text text-transparent mb-2">
                Fantasy Study Quest
              </h1>
              <p className="text-xl text-purple-200">{currentTitle}</p>
            </div>

            {showReward && (
              <div className="fixed top-4 right-4 bg-gradient-to-r from-yellow-400 to-orange-400 text-gray-900 px-6 py-4 rounded-lg shadow-2xl animate-bounce font-bold z-50">
                {rewardMessage}
              </div>
            )}

            <div className="grid md:grid-cols-3 gap-6 mb-8">
              <div className="bg-white bg-opacity-10 backdrop-blur-lg rounded-2xl p-6 border border-white border-opacity-20 shadow-xl">
                <div className="flex items-center gap-3 mb-2">
                  <div className="text-yellow-300"><AwardIcon /></div>
                  <div>
                    <p className="text-sm text-purple-200">Level & Points</p>
                    <p className="text-2xl font-bold">Level {level}</p>
                    <p className="text-lg text-yellow-300">{totalPoints} pts</p>
                  </div>
                </div>
              </div>

              <div className="bg-white bg-opacity-10 backdrop-blur-lg rounded-2xl p-6 border border-white border-opacity-20 shadow-xl">
                <div className="flex items-center gap-3 mb-2">
                  <div className="text-orange-400"><FlameIcon /></div>
                  <div>
                    <p className="text-sm text-purple-200">Current Streak</p>
                    <p className="text-3xl font-bold">{currentStreak} days</p>
                  </div>
                </div>
              </div>

              <div className="bg-white bg-opacity-10 backdrop-blur-lg rounded-2xl p-6 border border-white border-opacity-20 shadow-xl">
                <div className="flex items-center gap-3 mb-2">
                  <div className="text-blue-300"><ClockIcon /></div>
                  <div>
                    <p className="text-sm text-purple-200">Total Study Time</p>
                    <p className="text-2xl font-bold">{formatDuration(totalStudyTime)}</p>
                    <p className="text-sm text-blue-200">{sessionsCompleted} sessions</p>
                  </div>
                </div>
              </div>
            </div>

            <div className="flex gap-4 mb-6 justify-center flex-wrap">
              <button
                onClick={() => { setTimerMode('countdown'); setIsRunning(false); setTime(0); }}
                className={`px-6 py-3 rounded-xl font-semibold transition-all ${
                  timerMode === 'countdown'
                    ? 'bg-gradient-to-r from-pink-500 to-purple-500 shadow-lg scale-105'
                    : 'bg-white bg-opacity-20 hover:bg-opacity-30'
                }`}
              >
                Countdown
              </button>
              <button
                onClick={() => { setTimerMode('stopwatch'); setIsRunning(false); setTime(0); }}
                className={`px-6 py-3 rounded-xl font-semibold transition-all ${
                  timerMode === 'stopwatch'
                    ? 'bg-gradient-to-r from-pink-500 to-purple-500 shadow-lg scale-105'
                    : 'bg-white bg-opacity-20 hover:bg-opacity-30'
                }`}
              >
                Stopwatch
              </button>
              <button
                onClick={() => { setTimerMode('pomodoro'); setIsRunning(false); setTime(0); }}
                className={`px-6 py-3 rounded-xl font-semibold transition-all ${
                  timerMode === 'pomodoro'
                    ? 'bg-gradient-to-r from-pink-500 to-purple-500 shadow-lg scale-105'
                    : 'bg-white bg-opacity-20 hover:bg-opacity-30'
                }`}
              >
                Pomodoro
              </button>
            </div>

            <div className="bg-gradient-to-br from-purple-500 to-pink-500 rounded-3xl p-8 mb-6 shadow-2xl">
              {timerMode === 'countdown' && !isRunning && time === 0 && (
                <div className="mb-6">
                  <label className="block text-center mb-3 text-lg">Set Duration (minutes)</label>
                  <input
                    type="number"
                    min="1"
                    value={inputMinutes}
                    onChange={(e) => setInputMinutes(Math.max(1, parseInt(e.target.value) || 1))}
                    className="w-full bg-white bg-opacity-20 rounded-xl p-4 text-center text-2xl font-bold border-2 border-white border-opacity-30"
                  />
                </div>
              )}

              {timerMode === 'pomodoro' && !isRunning && time === 0 && (
                <div className="grid grid-cols-2 gap-4 mb-6">
                  <div>
                    <label className="block text-center mb-2">Work (min)</label>
                    <input
                      type="number"
                      min="1"
                      value={pomodoroWork}
                      onChange={(e) => setPomodoroWork(Math.max(1, parseInt(e.target.value) || 25))}
                      className="w-full bg-white bg-opacity-20 rounded-xl p-3 text-center text-xl font-bold border-2 border-white border-opacity-30"
                    />
                  </div>
                  <div>
                    <label className="block text-center mb-2">Break (min)</label>
                    <input
                      type="number"
                      min="1"
                      value={pomodoroBreak}
                      onChange={(e) => setPomodoroBreak(Math.max(1, parseInt(e.target.value) || 5))}
                      className="w-full bg-white bg-opacity-20 rounded-xl p-3 text-center text-xl font-bold border-2 border-white border-opacity-30"
                    />
                  </div>
                </div>
              )}

              {timerMode === 'pomodoro' && (
                <div className="text-center mb-4">
                  <span className={`px-6 py-2 rounded-full font-semibold text-lg ${
                    pomodoroPhase === 'work' ? 'bg-green-400 text-green-900' : 'bg-blue-400 text-blue-900'
                  }`}>
                    {pomodoroPhase === 'work' ? 'üìö Work Time' : '‚òï Break Time'}
                  </span>
                </div>
              )}

              <div className="text-center text-8xl font-bold mb-8 tracking-wider">
                {formatTime(time)}
              </div>

              <div className="flex gap-4 justify-center">
                {!isRunning ? (
                  <button
                    onClick={startTimer}
                    className="bg-green-500 hover:bg-green-600 p-6 rounded-full shadow-lg transition-all hover:scale-110"
                  >
                    <PlayIcon />
                  </button>
                ) : (
                  <button
                    onClick={pauseTimer}
                    className="bg-yellow-500 hover:bg-yellow-600 p-6 rounded-full shadow-lg transition-all hover:scale-110"
                  >
                    <PauseIcon />
                  </button>
                )}
                <button
                  onClick={resetTimer}
                  className="bg-red-500 hover:bg-red-600 p-6 rounded-full shadow-lg transition-all hover:scale-110"
                >
                  <RotateCcwIcon />
                </button>
              </div>
            </div>

            <div className="grid md:grid-cols-2 gap-6">
              <div className="bg-white bg-opacity-10 backdrop-blur-lg rounded-2xl p-6 border border-white border-opacity-20">
                <h3 className="text-2xl font-bold mb-4 flex items-center gap-2">
                  <span>üêæ</span> Study Companions
                </h3>
                <div className="grid grid-cols-3 gap-3">
                  {Object.entries(companions).map(([key, companion]) => {
                    const unlocked = unlockedCompanions.includes(key);
                    return (
                      <button
                        key={key}
                        onClick={() => unlocked && setCurrentCompanion(key)}
                        disabled={!unlocked}
                        className={`p-4 rounded-xl transition-all ${
                          unlocked
                            ? currentCompanion === key
                              ? 'bg-gradient-to-br from-yellow-400 to-orange-400 scale-105 shadow-lg'
                              : 'bg-white bg-opacity-20 hover:bg-opacity-30'
                            : 'bg-gray-700 opacity-50 cursor-not-allowed'
                        }`}
                      >
                        <div className="text-4xl mb-2">{unlocked ? companion.emoji : 'üîí'}</div>
                        <div className="text-xs">{companion.name}</div>
                        {!unlocked && <div className="text-xs text-gray-400">Lvl {companion.unlockLevel}</div>}
                      </button>
                    );
                  })}
                </div>
              </div>

              <div className="bg-white bg-opacity-10 backdrop-blur-lg rounded-2xl p-6 border border-white border-opacity-20">
                <h3 className="text-2xl font-bold mb-4 flex items-center gap-2">
                  <AwardIcon /> Titles
                </h3>
                <div className="space-y-2">
                  {titles.map((title) => {
                    const unlocked = unlockedTitles.includes(title.name);
                    return (
                      <button
                        key={title.name}
                        onClick={() => unlocked && setCurrentTitle(title.name)}
                        disabled={!unlocked}
                        className={`w-full p-3 rounded-xl text-left transition-all ${
                          unlocked
                            ? currentTitle === title.name
                              ? 'bg-gradient-to-r from-yellow-400 to-orange-400 text-gray-900 font-bold'
                              : 'bg-white bg-opacity-20 hover:bg-opacity-30'
                            : 'bg-gray-700 opacity-50 cursor-not-allowed'
                        }`}
                      >
                        <div className="flex justify-between items-center">
                          <span>{unlocked ? 'üèÜ' : 'üîí'} {title.name}</span>
                          {!unlocked && <span className="text-sm">Level {title.level}</span>}
                        </div>
                      </button>
                    );
                  })}
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    };

    ReactDOM.render(<FantasyStudyTimer />, document.getElementById('root'));
  </script>
</body>
</html>